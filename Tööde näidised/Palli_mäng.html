<!doctype html>
<html> 
 <head>  
 <title>Pallid</title>    
 <script>      var pallid=[             {"x":10 , "y":50, "r":10, "dx":1, "dy":0},             {"x":100, "y":30, "r":10, "dx":0, "dy":1}      ];      var tulemused=[        {"eesnimi":"Juku", "punkte": 7},        {"eesnimi":"Kati", "punkte": 8},        {"eesnimi":"Mati", "punkte": 5}      ];      var t, g; //tahvel, graafiline kontekst   
 var ykiirendus=0.1;      var algusaeg=new Date().getTime();      var pihtasloendur=0, m2ngK2ib=false;      var m2nguKestus=10000; //millisekundit   
 var algraadius=10;      function algus(){             t=document.getElementById("tahvel");             g=t.getContext("2d");             setInterval('liigu()', 50);      }      function m2nguAlgus(){         pihtasloendur=0;         algusaeg=new Date().getTime();         document.getElementById("nupp1").style.visibility="hidden";         for(var i=0; i<pallid.length; i++){
           pallid[i].r=algraadius;         }         m2ngK2ib=true;      }      function joonista(){          g.clearRect(0, 0, t.width, t.height);          for(var i=0; i<pallid.length; i++){            g.beginPath();            g.arc(pallid[i].x, pallid[i].y, pallid[i].r,                       0, 2*Math.PI, true);            g.fill();          }      }      function hiirAlla(e){         if(!m2ngK2ib){return;}         var tahvlikoht=t.getBoundingClientRect();         var hx=e.clientX-tahvlikoht.left;         var hy=e.clientY-tahvlikoht.top;         for(var i=0; i<pallid.length; i++){            var kaugusx=hx-pallid[i].x;            var kaugusy=hy-pallid[i].y;            var kaugus=Math.sqrt(kaugusx*kaugusx+kaugusy*kaugusy);            if(kaugus<pallid[i].r){              pallid[i].r=pallid[i].r*0.8;              pihtasloendur++;              var lopusona="pall";              if(pihtasloendur>1){                lopusona="palli";              }              document.getElementById("vastus2").innerHTML=                "Tabatud "+pihtasloendur+" "+lopusona;            }         }         joonista();     }      function liigu(){         if(!m2ngK2ib){return;}         for(var i=0; i<pallid.length; i++){           if(!kasSees(pallid[i])){             p6rka(pallid[i]);           }           pallid[i].dy+=ykiirendus;           pallid[i].x+=pallid[i].dx;           pallid[i].y+=pallid[i].dy;         }         document.getElementById("vastus1").innerHTML=           "Kulunud "+parseInt((new Date().getTime()-algusaeg)/1000)+" sek ";            joonista();         if(new Date().getTime()-algusaeg>m2nguKestus){           m2ngK2ib=false;           lisaTulemus(prompt("Palun eesnimi", "Niptiri"));           document.getElementById("nupp1").style.visibility="visible";         }       }       function kasSees(pall){             if(pall.x-pall.r<0){return false;}             if(pall.x+pall.r>t.width){return false;}             if(pall.y-pall.r<0){return false;}             if(pall.y+pall.r>t.height){return false;}
             return true;       }       function p6rka(pall){ //Põrkab üle läinud servast tagasi       
			 if(pall.x-pall.r<0){pall.dx=Math.abs(pall.dx);}       
			 if(pall.x+pall.r>t.width){pall.dx=-Math.abs(pall.dx);}      
			 if(pall.y-pall.r<0){pall.dy=Math.abs(pall.dy);}      
			 if(pall.y+pall.r>t.height){               pall.dy=-Math.abs(pall.dy);               pall.y=t.height-pall.r;             }               }      function sordiTulemusedPunktideJ2rgi(){           tulemused.sort(function(t1, t2){return t2.punkte-t1.punkte});      }      function kuvaTulemused(){         sordiTulemusedPunktideJ2rgi();         var t="<ol>";         for(var i=0; i<tulemused.length; i++){           t+="<li>"+tulemused[i].eesnimi+": "+             tulemused[i].punkte+" punkti</li>";         }         t+="</ol>";         document.getElementById("vastus3").innerHTML=t;      }      function lisaTulemus(enimi){        tulemused.push(          {            "eesnimi":enimi,            "punkte": pihtasloendur          }        );        kuvaTulemused();      }        </script>  </head>  <body onload="algus()">      <h1>Vajuta hiirega pallile</h1>      <canvas id="tahvel" width="300" height="200"                style="background-color:yellow"                onmousedown="hiirAlla(event)" ></canvas><br />      <div id="vastus1"></div>      <div id="vastus2"></div>      <div id="vastus3"></div>      <input type="button" id="nupp1" value="Alusta" onclick="m2nguAlgus()" /> 
			 </body>
			 </html>	